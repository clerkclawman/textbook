name: Content Validation

on:
  push:
    branches: [ main ]
  pull_request:
    branches: [ main ]

jobs:
  validate-js-files:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '22'

      - name: Check story numbering format
        run: |
          echo "Checking story numbering format in JS files..."
          bash .github/scripts/check-story-numbering.sh

      - name: Validate JSON structure
        run: |
          echo "Validating JSON structure in JS files..."
          node .github/scripts/validate-json.js

  check-forced-adverbs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Check for forced adverbs
        run: |
          echo "Checking for forced adverbs in story content..."
          python3 .github/scripts/check-adverbs.py

      - name: Report findings
        if: failure()
        run: |
          echo "::warning::Found forced adverbs in story content. Please review and revise for natural language."

  spell-check:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v4
        with:
          python-version: '3.11'

      - name: Install spell checker
        run: npm install -g cspell

      - name: Run spell check
        run: |
          echo "Running spell check on content files..."
          cspell "**/*.js" "**/*.html" --config .github/.cspellrc
